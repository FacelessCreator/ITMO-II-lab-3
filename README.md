# Лабораторная работа по ИИ III - deFaceBooked version
Изучаются принципы работы сверточных нейронных сетей. Используемая нейросеть состоит из предобученного компонента и обучаемых слоев.

Лабораторная работа частично автоматизирована с помощью **make**-скриптов.

**Скрипты написаны под GNU/Linux. Для использования в Windows вам придется модифицировать их.**

## Подготовка к работе

### Видеодрайверы
Убедитесь, что у вас установлены библиотеки машинного обучения. Если ваша ОС - **это ArchLinux**, и у вас видеокарта **NVIDIA**, то просто используйте ```make prepare-pacman-nvidia```. В любом другом случае читайте информацию о **tensorflow**. Можете запустить расчет и посметреть на выпадающие ошибки. 

Даже если у вас не получается запустить расчёт на видеокарте (например, если у вас нет выделенной видеокарты), расчёт будет идти. Однако будет задействован только центральный процессор, что значительно медленнее. 

### Библиотеки python
При желании можете создать отдельное виртуальное окружение ```make env``` и войти в него ```source env/bin/activate```.

Проект зависит от следующих библиотек:
* numpy 
* pandas 
* matplotlib 
* seaborn 
* sklearn 
* tensorflow
* tensorflow_hub
Вы можете установить их самостоятельно, или, если вы используете менеджер пакетов **pip**, воспользоваться командой ```make prepare-pip```.

## Выполнение лабораторной работы
[Скачайте flowers.tgz из официального источника](https://www.kaggle.com/alxmamaev/flowers-recognition) и распакуйте так, чтобы папка **src/flowers** содержала директории, относящиеся к классам цветов.

Задайте желаемые настройки сети в **scripts/constants.py**. Можно изменить слои создаваемой сети в **scripts/create_model.py**. 

Можете сразу запустить тренировку: ```make train```. **Тренировка будет продолжаться бесконечно долго**. В момент, когда вы довольны оценкой нейросети, вызовите прерывание алгоритма сочетанием клавиш ```ctrl+C```.

Обратите внимание, что **при любом изменении констант или алгоритма сборки модели автоматически будет запущена пересборка**. Таким образом, вы не можете одновременно держать натренированными несколько нейронных сетей.

После тренировки экзаменуйте нейросеть, запустив ```make test```. Будет показана таблица корреляций между классами - то, как часто нейросеть путает их между собой. В консоли выводится таблица **precision**, **recall**, **f1-score**.

## Источники
* [Прикладной ИИ - лабораторная работа 3](https://colab.research.google.com/drive/1cOuYWc8JFtysXDO5PNQl8CyKvnq3ef51?usp=sharing)
* [Classify Flowers with Transfer Learning](https://github.com/tensorflow/hub/blob/master/examples/colab/image_feature_vector.ipynb)

## Обратная связь
Напишите, где я намусорил... или оставьте другой отзыв.
> telegram: @theunnamedh
